<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Visitor Form</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700&family=Poppins:wght@300;400;600&display=swap"
        rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="assets/css/vms _css/visitorverify.css">
    <!-- Added CSS for personname suggestions dropdown and error styling -->
    <style>
        .suggestion-item {
            padding: 10px;
            cursor: pointer;
            border-bottom: 1px solid #eee;
        }

        .suggestion-item:hover {
            background-color: #f0f0f0;
        }

        .error {
            color: #dc3545;
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }
    </style>
</head>

<body class="bg-gray-100">
    <div class="h-l flex items-center justify-center p-4">
        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2">
            <div class="w-full max-w-5xl h-full bg-white rounded-lg shadow-md overflow-hidden flex flex-col">
                <div class="px-6 py-4 border-b text-xl font-semibold text-center"
                    style="font-family: 'Nunito', sans-serif;">
                    Visitor Registration Form
                </div>
                <form id="visitorForm" class="flex-1 overflow-y-auto p-6 space-y-4 form-scroll" autocomplete="off">
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div class="flex sm:flex-row flex-col items-center">
                            <label for="firstname" class="sm:mb-0 mb-1 sm:mr-2 text-sm font-medium">First Name</label>
                            <div class="form-group">
                                <input type="text" id="firstname" name="firstname" placeholder="Enter first name"
                                    class="w-full text-xs px-3 py-2 border rounded" />
                                <span class="error text-xs text-red-500" id="error-firstname"></span>
                            </div>
                        </div>

                        <div class="flex sm:flex-row flex-col items-center">
                            <label for="lastname" class="sm:mb-0 mb-1 sm:mr-2 text-sm font-medium">Last Name</label>
                            <div class="form-group">
                                <input type="text" id="lastname" name="lastname" placeholder="Enter last name"
                                    class="w-full text-xs px-3 py-2 border rounded" />
                                <span class="error text-xs text-red-500" id="error-lastname"></span>
                            </div>
                        </div>

                        <div class="flex sm:flex-row flex-col items-center">
                            <label for="gender" class="sm:mb-0 mb-1 sm:mr-2 text-sm font-medium">Gender</label>
                            <div class="form-group">
                                <select id="gender" name="gender" class="w-full text-xs px-3 py-2 border rounded">
                                    <option value="">Select gender</option>
                                    <option>Male</option>
                                    <option>Female</option>
                                    <option>Other</option>
                                </select>
                                <span class="error text-xs text-red-500" id="error-gender"></span>
                            </div>
                        </div>

                        <div class="flex sm:flex-row flex-col items-center">
                            <label for="contactnumber" class="sm:mb-0 mb-1 sm:mr-2 text-sm font-medium">Contact
                                Number</label>
                            <div class="form-group">
                                <input type="text" id="contactnumber" name="contactnumber"
                                    placeholder="Enter contact number"
                                    class="w-full text-xs px-3 py-2 border rounded" />
                                <span class="error text-xs text-red-500" id="error-contactnumber"></span>
                            </div>
                        </div>

                        <div class="flex sm:flex-row flex-col items-center">
                            <label for="email" class="sm:mb-0 mb-1 sm:mr-2 text-sm font-medium">Email Address</label>
                            <div class="form-group">
                                <input type="email" id="email" name="email" placeholder="Enter email address"
                                    class="w-full text-xs px-3 py-2 border rounded" />
                                <span class="error text-xs text-red-500" id="error-email"></span>
                            </div>
                        </div>

                        <div class="flex sm:flex-row flex-col items-center">
                            <label for="date" class="sm:mb-0 mb-1 sm:mr-2 text-sm font-medium">Meeting Date</label>
                            <div class="form-group">
                                <input type="date" id="date" name="date"
                                    class="w-full text-xs px-3 py-2 border rounded" />
                                <span class="error text-xs text-red-500" id="error-date"></span>
                            </div>
                        </div>

                        <div class="flex sm:flex-row flex-col items-center">
                            <!-- Fixed typo: MetinTime → Meeting Time -->
                            <label for="time" class="sm:mb-0 mb-1 sm:mr-2 text-sm font-medium">Meeting Time</label>
                            <div class="form-group">
                                <input type="time" id="time" name="time"
                                    class="w-full text-xs px-3 py-2 border rounded" />
                                <span class="error text-xs text-red-500" id="error-time"></span>
                            </div>
                        </div>

                        <div class="flex sm:flex-row flex-col items-center">
                            <label for="nationalid" class="sm:mb-0 mb-1 sm:mr-2 text-sm font-medium">National ID</label>
                            <div class="form-group">
                                <input type="text" id="nationalid" name="nationalid" placeholder="Enter national ID"
                                    class="w-full text-xs px-3 py-2 border rounded" />
                                <span class="error text-xs text-red-500" id="error-nationalid"></span>
                            </div>
                        </div>

                        <!-- Visitor Photo -->
                        <div class="flex sm:flex-row flex-col items-start mb-3">
                            <label for="photo" class="w-40 text-sm font-medium pt-2">Visitor Photo</label>
                            <div class="w-full">
                                <input type="file" id="photo" name="photo" accept="image/*"
                                    onchange="previewImage(this, 'mainPreview')" class="hidden" />
                                <div class="flex items-center gap-2">
                                    <button type="button"
                                        class="w-full text-xs px-3 py-2 border rounded choose-photo-btn"
                                        onclick="showModal('photo')">Choose Photo</button>
                                    <img id="mainPreview" class="photo-preview rounded border" alt="Preview" />
                                </div>
                                <span class="error text-xs text-red-500 block mt-1" id="error-photo"></span>
                            </div>
                        </div>

                        <div class="flex sm:flex-row flex-col items-center">
                            <label for="visit" class="sm:mb-0 mb-1 sm:mr-2 text-sm font-medium">Purpose of Visit</label>
                            <div class="form-group">
                                <!-- Fixed class: tw-full → w-full -->
                                <select id="visit" name="visit" class="w-full text-xs px-3 py-2 border rounded">
                                    <option value="">Select purpose</option>
                                </select>
                                <span class="error text-xs text-red-500" id="error-visit"></span>
                            </div>
                        </div>

                        <!-- Updated personname field to include suggestions dropdown -->
                        <div class="flex sm:flex-row flex-col items-center">
                            <label for="personname" class="sm:mb-0 mb-1 sm:mr-2 text-sm font-medium">Person Name</label>
                            <div class="form-group relative">
                                <input type="text" id="personname" name="personname"
                                    placeholder="Enter name of person to meet"
                                    class="w-full text-xs px-3 py-2 border rounded" autocomplete="off" />
                                <span class="error text-xs text-red-500" id="error-personname"></span>
                                <!-- Added div for suggestions dropdown -->
                                <div id="personname-suggestions"
                                    class="hidden absolute z-10 bg-white border border-gray-300 w-full max-h-60 overflow-y-auto shadow-lg">
                                </div>
                            </div>
                        </div>

                        <div class="flex sm:flex-row flex-col items-center">
                            <!-- Added readonly attribute to department field -->
                            <label for="department" class="sm:mb-0 mb-1 sm:mr-2 text-sm font-medium">Department</label>
                            <div class="form-group">
                                <input type="text" id="department" name="department"
                                    placeholder="Enter the visiting department"
                                    class="w-full text-xs px-3 py-2 border rounded" readonly />
                                <span class="error text-xs text-red-500" id="error-department"></span>
                            </div>
                        </div>

                        <div class="flex sm:flex-row flex-col items-center max-w-md w-full">
                            <label for="durationtime" class="sm:mb-0 mb-1 sm:mr-2 text-sm font-medium w-32">
                                Expected Duration
                            </label>
                            <div
                                class="form-group flex sm:flex-row flex-col sm:space-x-2 space-y-2 sm:space-y-0 w-full">
                                <div class="w-full sm:w-1/3">
                                    <select id="durationUnit" name="durationUnit"
                                        class="w-full text-xs px-3 py-2 border rounded">
                                        <option value="">Select unit</option>
                                    </select>
                                </div>
                                <div class="w-full sm:w-2/3">
                                    <input type="number" id="durationtime" name="durationtime"
                                        placeholder="Enter expected duration"
                                        class="w-full text-xs px-3 py-2 border rounded" min="1" />
                                    <span class="error text-xs text-red-500 mt-1 block" id="error-durationtime"></span>
                                </div>
                            </div>
                        </div>

                        <div class="flex sm:flex-row flex-col items-center">
                            <label for="visitortype" class="sm:mb-0 mb-1 sm:mr-2 text-sm font-medium">Visitor
                                Type</label>
                            <div class="form-group">
                                <select id="visitortype" name="visitortype"
                                    class="w-full text-xs px-3 py-2 border rounded">
                                    <option value="">Select visitor type</option>
                                </select>
                                <span class="error text-xs text-red-500" id="error-visitortype"></span>
                            </div>
                        </div>

                        <div class="flex sm:flex-row flex-col items-center">
                            <label for="vehicletype" class="sm:mb-0 mb-1 sm:mr-2 text-sm font-medium">Vehicle
                                Type</label>
                            <div class="form-group">
                                <input type="text" id="vehicletype" name="vehicletype" placeholder="Enter vehicle type"
                                    class="w-full text-xs px-3 py-2 border rounded" />
                                <span class="error text-xs text-red-500" id="error-vehicletype"></span>
                            </div>
                        </div>

                        <div class="flex sm:flex-row flex-col items-center">
                            <label for="vehiclenumber" class="sm:mb-0 mb-1 sm:mr-2 text-sm font-medium">Vehicle
                                Number</label>
                            <div class="form-group">
                                <input type="text" id="vehiclenumber" name="vehiclenumber"
                                    placeholder="Enter vehicle number"
                                    class="w-full text-xs px-3 py-2 border rounded" />
                                <span class="error text-xs text-red-500" id="error-vehiclenumber"></span>
                            </div>
                        </div>

                        <div class="flex sm:flex-row flex-col items-center sm:col-span-2">
                            <label class="sm:mr-2 text-sm font-medium">Include Driver?</label>
                            <input type="checkbox" id="driverToggle" onchange="toggleDriverDetails()" />
                        </div>
                    </div>

                    <div id="driverDetails" class="hidden mt-4 space-y-4 border-t pt-4">
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <div class="flex sm:flex-row flex-col items-center">
                                <label for="drivername" class="sm:mb-0 mb-1 sm:mr-2 text-sm font-medium">Driver
                                    Name</label>
                                <div class="form-group">
                                    <input type="text" id="drivername" name="drivername" placeholder="Enter driver name"
                                        class="w-full text-xs px-3 py-2 border rounded" />
                                    <span class="error text-xs text-red-500" id="error-drivername"></span>
                                </div>
                            </div>
                            <div class="flex sm:flex-row flex-col items-center">
                                <label for="drivermobile" class="sm:mb-0 mb-1 sm:mr-2 text-sm font-medium">Driver
                                    Mobile</label>
                                <div class="form-group">
                                    <input type="text" id="drivermobile" name="drivermobile"
                                        placeholder="Enter driver mobile"
                                        class="w-full text-xs px-3 py-2 border rounded" />
                                    <span class="error text-xs text-red-500" id="error-drivermobile"></span>
                                </div>
                            </div>
                            <div class="flex sm:flex-row flex-col items-center">
                                <label for="drivernationalid" class="sm:mb-0 mb-1 sm:mr-2 text-sm font-medium">Driver
                                    National ID</label>
                                <div class="form-group">
                                    <input type="text" id="drivernationalid" name="drivernationalid"
                                        placeholder="Enter driver national ID"
                                        class="w-full text-xs px-3 py-2 border rounded" />
                                    <span class="error text-xs text-red-500" id="error-drivernationalid"></span>
                                </div>
                            </div>
                            <!-- Driver Photo -->
                            <div class="flex sm:flex-row flex-col items-start mb-3">
                                <label for="driverphoto" class="w-40 text-sm font-medium pt-2">Driver Photo</label>
                                <div class="w-full">
                                    <input type="file" id="driverphoto" name="driverphoto" accept="image/*"
                                        onchange="previewImage(this, 'driverPreview')" class="hidden" />
                                    <div class="flex items-center gap-2">
                                        <button type="button"
                                            class="w-full text-xs px-3 py-2 border rounded choose-photo-btn"
                                            onclick="showModal('driverphoto')">Choose Photo</button>
                                        <img id="driverPreview" class="photo-preview rounded border" alt="Preview" />
                                    </div>
                                    <span class="error text-xs text-red-500 block mt-1" id="error-driverphoto"></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="flex sm:flex-row flex-col items-center">
                        <label for="notes" class="sm:mb-0 mb-1 sm:mr-2 text-sm font-medium">Notes</label>
                        <div class="form-group">
                            <textarea id="notes" name="notes" rows="1" placeholder="Enter any notes..."
                                class="w-full text-xs px-3 py-2 border rounded"></textarea>
                            <span class="error text-xs text-red-500" id="error-notes"></span>
                        </div>
                    </div>

                    <!-- Added error-general span for form submission errors -->
                    <div>
                        <span class="error text-xs text-red-500" id="error-general"></span>
                    </div>

                    <div class="flex justify-end mt-6">
                        <button type="submit" id="submitBtn" class="btn-outline-primary rounded-full text-sm">
                            <span class="loader"></span>
                            <span>Submit</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div id="photoModal" class="modal">
        <div class="modal-content">
            <h3>Select Photo Source</h3>
            <button class="gallery-btn" onclick="openGallery()">Gallery</button>
            <button class="camera-btn" onclick="openCamera()">Camera</button>
            <button class="close-btn" onclick="closeModal()">Close</button>
        </div>
    </div>

    <!-- Modal for Camera Stream -->
    <div id="cameraModal" class="modal">
        <div class="modal-content">
            <h3>Capture Photo</h3>
            <div id="cameraStreamContainer" class="flex flex-col items-center">
                <video id="cameraPreview" class="w-48 h-36 rounded border" autoplay></video>
                <div class="flex space-x-2 mt-2">
                    <button id="captureBtn" type="button" class="px-3 py-2 border rounded text-xs"
                        onclick="capturePhoto(currentFileInputId)">Capture</button>

                    <button class="close-btn px-3 py-2 border rounded text-xs"
                        onclick="closeCameraModal()">Close</button>
                </div>
            </div>
        </div>
    </div>

    <video id="cameraPreview" style="display: none;"></video>
    <canvas id="cameraCanvas" style="display: none;"></canvas>

    <script src="assets/js/main-content-script/visitorverify-script.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</body>

</html>